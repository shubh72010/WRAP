<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Image Editor</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #222; color: #eee; }
  #canvas { border: 1px solid #555; display: block; margin-bottom: 10px; max-width: 100%; }
  input, button { margin: 5px 0; padding: 8px; width: 100%; max-width: 300px; }
  #textInput { width: 100%; max-width: 300px; }
</style>
</head>
<body>

<h1>Simple Image Editor</h1>
<input type="file" id="imgUpload" accept="image/*" />
<br />
<canvas id="canvas" width="500" height="400"></canvas>
<br />
<input type="text" id="textInput" placeholder="Enter text to add" />
<button id="addTextBtn">Add Text</button>
<br />
<button id="grayscaleBtn">Toggle Grayscale</button>
<button id="brightenBtn">Increase Brightness</button>
<button id="resetBtn">Reset Image</button>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const imgUpload = document.getElementById('imgUpload');
  const textInput = document.getElementById('textInput');
  const addTextBtn = document.getElementById('addTextBtn');
  const grayscaleBtn = document.getElementById('grayscaleBtn');
  const brightenBtn = document.getElementById('brightenBtn');
  const resetBtn = document.getElementById('resetBtn');

  let img = new Image();
  let originalPixels = null;
  let isGrayscale = false;
  let brightnessLevel = 0;

  imgUpload.addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(event) {
      img.onload = () => {
        canvas.width = img.width > 800 ? 800 : img.width;
        canvas.height = img.height > 600 ? 600 : img.height;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        originalPixels = ctx.getImageData(0, 0, canvas.width, canvas.height);
        isGrayscale = false;
        brightnessLevel = 0;
      };
      img.src = event.target.result;
    };
    reader.readAsDataURL(file);
  });

  addTextBtn.onclick = () => {
    const text = textInput.value.trim();
    if (!text) return alert('Type some text first.');

    ctx.font = '30px Arial';
    ctx.fillStyle = 'white';
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 2;
    ctx.textBaseline = 'top';

    // Adds text top-left corner - you can customize positioning
    ctx.strokeText(text, 10, 10);
    ctx.fillText(text, 10, 10);

    textInput.value = '';
  };

  grayscaleBtn.onclick = () => {
    if (!originalPixels) return;
    if (!isGrayscale) {
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;
      for (let i = 0; i < data.length; i += 4) {
        const avg = (data[i] + data[i+1] + data[i+2]) / 3;
        data[i] = data[i+1] = data[i+2] = avg;
      }
      ctx.putImageData(imageData, 0, 0);
      isGrayscale = true;
    } else {
      ctx.putImageData(originalPixels, 0, 0);
      isGrayscale = false;
      if (brightnessLevel > 0) applyBrightness(brightnessLevel);
    }
  };

  brightenBtn.onclick = () => {
    if (!originalPixels) return;
    brightnessLevel += 20;
    applyBrightness(brightnessLevel);
  };

  resetBtn.onclick = () => {
    if (!originalPixels) return;
    ctx.putImageData(originalPixels, 0, 0);
    isGrayscale = false;
    brightnessLevel = 0;
  };

  function applyBrightness(amount) {
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    for (let i = 0; i < data.length; i += 4) {
      data[i] = clamp(data[i] + amount);
      data[i+1] = clamp(data[i+1] + amount);
      data[i+2] = clamp(data[i+2] + amount);
    }
    ctx.putImageData(imageData, 0, 0);
  }

  function clamp(value) {
    return Math.max(0, Math.min(255, value));
  }
</script>

</body>
</html>